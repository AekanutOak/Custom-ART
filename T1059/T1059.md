# T1059.001 - Command and Scripting Interpreter: PowerShell
## [Description from ATT&CK](https://attack.mitre.org/techniques/T1059/001)
<blockquote>Adversaries may abuse commands and scripts for execution using various platform such as AutoIt, Powershell, Command promt, INF-SCT, and more. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system.(Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the <code>Start-Process</code> cmdlet which can be used to run an executable and the <code>Invoke-Command</code> cmdlet which runs a command locally or on a remote computer (though administrator permissions are required to use PowerShell to connect to remote systems).</blockquote>

## Atomic Tests

- [Atomic Test #1 - AutoIt suspicious script](#atomic-test-1---autoit)


<br/>

## Atomic Test #1 - AutoIt suspicious script
Use autoit to execute suspicious au3 script

**Supported Platforms:** Windows


**auto_generated_guid:** a9b93f17-31cb-435d-a462-5e838a2a6026




#### Inputs:
| Name | Description | Type | Default Value |
|------|-------------|------|---------------|
| script_path | au3 script path | path | PathToAtomicsFolder\T1059\src\calc.au3 |
| autoit_path | autoit.exe path | path | C:\Program Files (x86)\AutoIt3\AutoIt3.exe |


#### Attack Commands: Run with `powershell`! 


```cmd
Start-Process -FilePath "#{autoit_path}" -ArgumentList "#{script_path}" -Wait
```

#### Dependencies:  Run with `powershell`!
##### Description: AutoIt is required.
##### Check Prereq Commands:
```powershell
if(Test-Path "#{autoit_path}") {
          Write-Host "AutoIt is installed."
          exit 0
} else {
          Write-Host "AutoIt is not installed."
          exit 1
      }
```
##### Get Prereq Commands:
```powershell
$AutoItURL = "https://www.autoitscript.com/cgi-bin/getfile.pl?autoit3/autoit-v3-setup.exe"
$InstallerPath = "$env:TEMP\autoit-v3-setup.exe"
if(-not (Test-Path "#{autoit_path}")) {
          Invoke-WebRequest -Uri $AutoItURL -OutFile $InstallerPath
          Start-Process -FilePath $InstallerPath -ArgumentList "/S" -Wait
          Remove-Item $InstallerPath
      }
```



<br/>
<br/>
